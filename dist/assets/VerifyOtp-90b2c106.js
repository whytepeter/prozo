import{s as C,i as j,v as o,L as E,j as L,M,N as R,r,o as h,a as x,w as v,d as y,P as F,b as c,e as t,t as P,q as w,m as S,x as W,n as q}from"./index-ffa3455d.js";const D=t("div",{class:"grid grid-cols-1 gap-2 px-4"},[t("h3",{class:"text-2xl font-semibold text-primary"}," Weâ€™ve sent you an OTP. "),t("p",{class:"text-sm text-dark-400"}," Kindly input the OTP sent to the email or phone number you provided. ")],-1),K={class:"grid grid-cols-1 gap-6"},U={class:"flex items-center justify-center gap-2 text-sm text-dark-600"},z={class:"flex h-9 w-9 items-center justify-center rounded-xl bg-dark-50 text-lg"},A={class:"flex h-9 w-9 items-center justify-center rounded-xl bg-dark-50 text-lg"},G={class:"ion-padding mb-4"},Q={__name:"VerifyOtp",setup(H){const f=C("http"),O=j(),u=o(""),i=E({otp:!1}),b=o(!1),d=o(!1),a=o(2),n=o("00"),p=o(120),m=o(!1),_=async()=>{const{value:e}=await F.get({key:"userEmail"});u.value=e,console.log(u.value)};_(),L(()=>{_()}),M(()=>{g()}),R(()=>{i.otp=!1});function g(){m.value=!0;const e=setInterval(function(){a.value=parseInt(p.value/60,10),n.value=parseInt(p.value%60,10),a.value=a.value<10?"0"+a.value:a.value,n.value=n.value<10?"0"+n.value:n.value,--p.value<0&&(p.value=120,m.value=!1,clearInterval(e))},1e3)}const k=async e=>{if(console.log(e),e.length==6){i.otp=!1,d.value=!0;try{const s=await f({endpoint:"VerifyOtp",httpMethod:"post",body:{userEmailOrPhone:u.value,code:e}});d.value=!1,console.log(s),O.push({name:"ResetPassword"})}catch(s){d.value=!1;const l=s.response.data.message;i.otp=l,console.log(l),showToast("error",l)}}},T=async()=>{try{const e=await f({endpoint:"SendOtp",httpMethod:"post",body:{userEmailOrPhone:u.value}});console.log(e),g(),showToast("success","OTP code sent, please check your mail")}catch(e){const s=e.response.data.message;console.log(s),showToast("error",s)}};return(e,s)=>{const l=r("PNav"),I=r("POtp"),N=r("PButton"),V=r("PFooter"),B=r("PLoader");return h(),x(y(q),null,{default:v(()=>[c(l),c(y(S),{fullscreen:""},{default:v(()=>[D,t("div",K,[c(I,{onChange:k,error:i.otp,class:"mx-auto w-10/12"},null,8,["error"]),t("div",U,[t("div",z,P(a.value),1),w(" : "),t("div",A,P(n.value),1)])])]),_:1}),c(V,null,{default:v(()=>[t("div",G,[c(N,{loading:b.value,onClick:T,disabled:m.value,fill:"outline",block:""},{default:v(()=>[w("Resend OTP")]),_:1},8,["loading","disabled"])])]),_:1}),d.value?(h(),x(B,{key:0})):W("",!0)]),_:1})}}};export{Q as default};
