import{s as A,u as O,v as C,c as x,L as q,M as J,r as v,o as c,a as w,w as m,b as r,d as p,n as S,m as F,h,O as K,q as G,x as $,e as u,z as T,g as Q,k as W,l as X,t as y,F as Y,y as Z,B as ee}from"./index-ffa3455d.js";const ae="/assets/editProfileIcon-83047e3a.svg",le=u("div",{class:"grid grid-cols-1 px-4"},[u("div",null,[u("img",{src:ae,alt:""})]),u("h3",{class:"text-2xl font-semibold text-primary"},"Edit Profile")],-1),te=["onSubmit"],oe={__name:"EditProfile",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(D,{emit:P}){const g=A("http"),f=O(),{validateEmail:M,processNumber:k,formatDate:V,showToast:s,processError:U}=T,e=C({}),B=x(()=>f.getlocationAreas&&f.getlocationAreas.map(o=>({label:o.name,value:o.name}))),b=x(()=>f.getUser),i=x(()=>b.value&&b.value.location);delete b.location,e.value={...b.value},e.value.location={...i.value};const l=C(!1),t=q({first_name:!1,last_name:!1,email:!1,address:!1,phone_number:!1,location_area:!1,landmark:!1});console.log(e.value),J(()=>{e.value={...b.value},e.value.location={...i.value}});function L(){return e.value.first_name.trim()===""?(t.first_name="Please fill in your first name",!1):e.value.last_name.trim()===""?(t.last_name="Please fill in your last name",!1):e.value.email.trim()===""?(t.email="Please fill in your email address",!1):M(e.value.email)?e.value.phone_number.trim()===""?(t.phone_number="Please fill in your phone number",!1):e.value.location.address&&e.value.location.address.trim()===""?(t.address="Please fill in your address",!1):e.value.location.location_area&&e.value.location.location_area.trim()===""?(t.location_area="Please fill in your location area",!1):(Object.keys(t).forEach(o=>{t[o]=!1}),!0):(t.email="Email is badly formated",!1)}const d=async()=>{if(L()){l.value=!0;const o={first_name:e.value.first_name,last_name:e.value.last_name,phone_number:e.value.phone_number,gender:e.value.gender,dob:e.value.dob,address:e.value.location.address,landmark:e.value.location.landmark,location_area:e.value.location.location_area};console.log(o);try{const a=await g({endpoint:"UpdateAccount",httpMethod:"patch",body:o});console.log(a),await N(),l.value=!1,P("close"),s("success","Profile updated successfully")}catch(a){l.value=!1;const _=U(a);console.log(_)}}},N=async()=>{try{const o=await g({endpoint:"GetUser",httpMethod:"get"});console.log(o),f.$patch({user:o}),j(o)}catch(o){const a=U(o);s("error",a),console.log(a)}},j=async o=>{try{const a=await g({endpoint:"GetUserLocation",httpMethod:"get"});o.location=a,f.$patch({user:o}),console.log(o)}catch(a){console.log(a)}};return(o,a)=>{const _=v("PInput"),R=v("PTextarea"),E=v("PSelect"),z=v("PButton"),I=v("PLoader"),H=v("PModal");return c(),w(H,{onClose:a[8]||(a[8]=n=>o.$emit("close")),isOpen:D.isOpen,type:"full",showCloseButton:!0},{default:m(()=>[r(p(S),null,{default:m(()=>[r(p(F),{fullscreen:"",class:""},{default:m(()=>[le,e.value?(c(),h("form",{key:0,onSubmit:K(d,["prevent"]),class:"ion-padding grid grid-cols-1 pb-40"},[r(_,{modelValue:e.value.first_name,"onUpdate:modelValue":a[0]||(a[0]=n=>e.value.first_name=n),label:"First Name",type:"text",disabled:l.value,inputmode:"text",error:t.first_name},null,8,["modelValue","disabled","error"]),r(_,{modelValue:e.value.last_name,"onUpdate:modelValue":a[1]||(a[1]=n=>e.value.last_name=n),label:"Last Name",type:"text",disabled:l.value,inputmode:"text",error:t.last_name},null,8,["modelValue","disabled","error"]),r(_,{modelValue:e.value.phone_number,"onUpdate:modelValue":a[2]||(a[2]=n=>e.value.phone_number=n),label:"Phone Number ",type:"tel",disabled:l.value,inputmode:"numeric",error:t.phone_number},null,8,["modelValue","disabled","error"]),r(R,{modelValue:e.value.location.address,"onUpdate:modelValue":a[3]||(a[3]=n=>e.value.location.address=n),label:"Address",disabled:l.value,error:t.address},null,8,["modelValue","disabled","error"]),r(E,{fullscreen:"",value:e.value.location.location_area,onUpdate:a[4]||(a[4]=n=>e.value.location.location_area=n),options:B.value,label:"Location Area",disabled:l.value,error:t.location_area},null,8,["value","options","disabled","error"]),r(_,{modelValue:e.value.location.landmark,"onUpdate:modelValue":a[5]||(a[5]=n=>e.value.location.landmark=n),label:"Land Mark ",error:t.landmark},null,8,["modelValue","error"]),r(E,{autoHeight:"",value:e.value.gender,disabled:l.value,onUpdate:a[6]||(a[6]=n=>e.value.gender=n),options:[{label:"Male",value:"Male"},{label:"Female",value:"Female"}],label:"Gender",error:t.gender},null,8,["value","disabled","error"]),r(_,{modelValue:e.value.dob,"onUpdate:modelValue":a[7]||(a[7]=n=>e.value.dob=n),label:"Date Of Birth ",type:"date",max:"2010-12-31",disabled:l.value,error:t.dob},null,8,["modelValue","disabled","error"]),r(z,{loading:l.value,type:"submit",class:"mt-2",block:""},{default:m(()=>[G("Save")]),_:1},8,["loading"])],40,te)):$("",!0)]),_:1}),l.value?(c(),w(I,{key:0})):$("",!0)]),_:1}),l.value?(c(),w(I,{key:0,color:"yellow"})):$("",!0)]),_:1},8,["isOpen"])}}},se=u("h3",{class:"px-4 pb-2 text-2xl font-semibold text-primary"},"My Profile",-1),re={class:"grid grid-cols-1 gap-3 bg-tertiary-light px-4"},ne={class:"flex flex-col items-center gap-2 pb-6 pt-2 text-center text-xl font-semibold text-primary"},ie={class:"flex h-24 w-24 flex-shrink-0 items-center items-center justify-center rounded-full border-2 border-tertiary bg-primary p-2 text-2xl font-semibold text-tertiary"},ue={key:0,class:"grid grid-cols-1 gap-1 bg-white py-4"},de={class:"text-xs text-dark-400"},ce={key:1,class:"text-center text-xs text-dark-400"},ve={__name:"ProfileInformation",setup(D){const P=A("http"),{initials:g,showToast:f,processError:M}=T,k=O(),V=C(!1),s=x(()=>k.getUser),U=x(()=>[{title:"Email",value:s.value.email},{title:"Phone Number",value:s.value.phone_number},{title:"Address",value:s.value.location.address},{title:"Location Area",value:s.value.location.location_area},{title:"Land Mark",value:s.value.location.landmark},{title:"Gender",value:s.value.gender},{title:"Date of Birth",value:s.value.dob}]),e=async i=>{await B(),i.target.complete()},B=async()=>{try{const i=await P({endpoint:"GetUser",httpMethod:"get"});console.log(i),k.$patch({user:i}),b(i)}catch(i){const l=M(i);f("error",l),console.log(l)}},b=async i=>{try{const l=await P({endpoint:"GetUserLocation",httpMethod:"get"});i.location=l,k.$patch({user:i}),console.log(i)}catch(l){console.log(l)}};return(i,l)=>{const t=v("PNav"),L=v("PButton");return c(),w(p(S),null,{default:m(()=>[r(p(Q),{class:"ion-no-border bg-tertiary-light"},{default:m(()=>[r(t,{color:"tertiary-light"}),se]),_:1}),r(p(F),{fullscreen:"",color:"ptertiary"},{default:m(()=>[r(p(W),{slot:"fixed",onIonRefresh:l[0]||(l[0]=d=>e(d))},{default:m(()=>[r(p(X))]),_:1}),u("div",re,[u("div",ne,[u("div",ie,y(p(g)(s.value&&s.value)),1),u("span",null,y(s.value&&s.value.first_name)+" "+y(s.value&&s.value.last_name),1),r(L,{onClick:l[1]||(l[1]=d=>V.value=!0),size:"small",fill:"outline"},{default:m(()=>[G("Edit Profile")]),_:1})])]),s.value?(c(),h("div",ue,[(c(!0),h(Y,null,Z(U.value,(d,N)=>(c(),h("div",{class:"last:border-o flex justify-between gap-4 border-b border-dark-50 p-4",key:N},[u("span",de,y(d.title),1),u("span",{class:ee([d.value?"text-dark-500":"text-dark-300","text-right text-sm "])},y(d.value?d.value:"N/A"),3)]))),128))])):(c(),h("div",ce," Pull to refresh "))]),_:1}),r(oe,{user:s.value,isOpen:V.value,onClose:l[2]||(l[2]=d=>V.value=!1)},null,8,["user","isOpen"])]),_:1})}}};export{ve as default};
